#!/usr/bin/env zsh

function aichat-clip() {
  clipboard=$(xclip -selection clipboard -out | tr -d '\r')

  if [ -z "$clipboard" ]; then
    echo "Clipboard is empty."
    return
  fi

  block='```'
  clipboard_block="${block}\n${clipboard}\n${block}"
  query="$1"

  echo -e "\e[1;37m$clipboard_block\e[0m"

  aichat -r explain "$clipboard_block\n\n$query"
}

aichat-clip "$1"
